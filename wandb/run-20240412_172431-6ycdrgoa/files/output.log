
  0%|                                                                                          | 0/5250 [00:00<?, ?it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
  0%|                                                                               | 1/5250 [01:08<99:16:53, 68.09s/it]
  7%|██████▎                                                                             | 7/94 [00:01<00:16,  5.18it/s]
{'loss': 7.1734, 'grad_norm': 607.3754272460938, 'learning_rate': 3.8095238095238096e-08, 'epoch': 0.01}
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 17%|██████████████▏                                                                    | 16/94 [00:03<00:16,  4.70it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 28%|██████████████████████▉                                                            | 26/94 [00:05<00:14,  4.73it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 37%|██████████████████████████████▉                                                    | 35/94 [00:07<00:13,  4.52it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 48%|███████████████████████████████████████▋                                           | 45/94 [00:09<00:10,  4.76it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 55%|█████████████████████████████████████████████▉                                     | 52/94 [00:11<00:10,  4.17it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 66%|██████████████████████████████████████████████████████▋                            | 62/94 [00:13<00:06,  4.68it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 73%|████████████████████████████████████████████████████████████▉                      | 69/94 [00:15<00:05,  4.21it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 82%|███████████████████████████████████████████████████████████████████▉               | 77/94 [00:17<00:05,  3.02it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 91%|███████████████████████████████████████████████████████████████████████████▉       | 86/94 [00:19<00:01,  4.53it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

100%|███████████████████████████████████████████████████████████████████████████████████| 94/94 [00:21<00:00,  4.81it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

torch.Size([8, 3, 224, 224])
{'eval_loss': 7.055032730102539, 'eval_accuracy': 1.73, 'eval_runtime': 23.8115, 'eval_samples_per_second': 31.581, 'eval_steps_per_second': 3.948, 'epoch': 0.01}
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
  0%|                                                                              | 2/5250 [02:20<102:44:46, 70.48s/it]
  9%|███████▏                                                                            | 8/94 [00:01<00:15,  5.46it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 18%|███████████████                                                                    | 17/94 [00:03<00:16,  4.67it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])

 29%|███████████████████████▊                                                           | 27/94 [00:05<00:13,  4.85it/s]
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
  File "run.py", line 173, in <module>                                                  | 34/94 [00:06<00:12,  4.79it/s]
    trainer.train()
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/transformers/trainer.py", line 1780, in train
    return inner_training_loop(
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/transformers/trainer.py", line 2193, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/transformers/trainer.py", line 2577, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/transformers/trainer.py", line 3365, in evaluate
    output = eval_loop(
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/transformers/trainer.py", line 3544, in evaluation_loop
    for step, inputs in enumerate(dataloader):
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/accelerate/data_loader.py", line 462, in __iter__
    next_batch = next(dataloader_iter)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 678, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 2814, in __getitems__
    batch = self.__getitem__(keys)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 2810, in __getitem__
    return self._getitem(key)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 2795, in _getitem
    formatted_output = format_table(
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/formatting/formatting.py", line 629, in format_table
    return formatter(pa_table, query_type=query_type)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/formatting/formatting.py", line 400, in __call__
    return self.format_batch(pa_table)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/formatting/formatting.py", line 449, in format_batch
    batch = self.python_features_decoder.decode_batch(batch)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/formatting/formatting.py", line 221, in decode_batch
    return self.features.decode_batch(batch) if self.features else batch
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/features/features.py", line 1983, in decode_batch
    [
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/features/features.py", line 1984, in <listcomp>
    decode_nested_example(self[column_name], value, token_per_repo_id=token_per_repo_id)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/features/features.py", line 1341, in decode_nested_example
    return schema.decode_example(obj, token_per_repo_id=token_per_repo_id)
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/datasets/features/image.py", line 185, in decode_example
    image.load()  # to avoid "Too many open files" errors
  File "/bask/projects/p/phwq4930-gbm/Zeyu/pyvenv/medfla2/lib/python3.8/site-packages/PIL/ImageFile.py", line 291, in load
    n, err_code = decoder.decode(b)
KeyboardInterrupt
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])
torch.Size([8, 3, 224, 224])